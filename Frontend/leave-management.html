<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leave Management - Employee Timesheet</title>
    <link rel="stylesheet" href="css/dashboard.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/leave.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i class="fas fa-clock"></i>
                    <h2>Timesheet</h2>
                </div>
            </div>
            <div class="sidebar-menu">
                <ul>
                    <li>
                        <a href="admin-dashboard.html">
                            <i class="fas fa-home"></i>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="user-management.html">
                            <i class="fas fa-users-cog"></i>
                            <span>User Management</span>
                        </a>
                    </li>
                    <li class="active">
                        <a href="leave-management.html">
                            <i class="fas fa-calendar-check"></i>
                            <span>Leave Management</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="sidebar-footer">
                <button id="logout-btn" class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Navigation -->
            <div class="top-nav">
                <div class="nav-left">
                    <button id="toggle-sidebar">
                        <i class="fas fa-bars"></i>
                    </button>
                    <h2>Leave Management</h2>
                </div>
                <div class="nav-right">
                    <div class="user-info">
                        <span id="admin-name">Loading...</span>
                        <i class="fas fa-user-circle"></i>
                    </div>
                </div>
            </div>

            <!-- Leave Management Content -->
            <div class="leave-management-content">
                <!-- Statistics Cards -->
                <div class="stats-cards">
                    <div class="stat-card pending">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Pending Requests</h3>
                            <p id="pending-count">0</p>
                        </div>
                    </div>
                    <div class="stat-card approved">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Approved</h3>
                            <p id="approved-count">0</p>
                        </div>
                    </div>
                    <div class="stat-card rejected">
                        <div class="stat-icon">
                            <i class="fas fa-times-circle"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Rejected</h3>
                            <p id="rejected-count">0</p>
                        </div>
                    </div>
                    <div class="stat-card total">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h3>Total Requests</h3>
                            <p id="total-count">0</p>
                        </div>
                    </div>
                </div>

                <!-- Leave Requests Table -->
                <div class="leave-requests-section">
                    <div class="section-header">
                        <h3><i class="fas fa-list"></i> All Leave Requests</h3>
                        <div class="filters">
                            <select id="status-filter">
                                <option value="all">All Status</option>
                                <option value="pending">Pending</option>
                                <option value="approved">Approved</option>
                                <option value="rejected">Rejected</option>
                            </select>
                            <input type="text" id="search-employee" placeholder="Search employee...">
                        </div>
                    </div>
                    
                    <div class="table-container">
                        <table class="admin-table" id="leave-requests-table">
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>Leave Type</th>
                                    <th>Start Date</th>
                                    <th>End Date</th>
                                    <th>Duration</th>
                                    <th>Status</th>
                                    <th>Applied On</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="leave-requests-body">
                                <!-- Leave requests will be loaded here -->
                                <tr>
                                    <td colspan="8" class="loading-cell">
                                        <div class="loading-spinner">
                                            <i class="fas fa-spinner fa-spin"></i> Loading leave requests...
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Approve/Reject Modal -->
    <div id="action-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Approve Leave Request</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <div id="leave-summary">
                    <!-- Leave request summary will be shown here -->
                </div>
                <form id="action-form">
                    <input type="hidden" id="action-leave-id">
                    <div class="form-group" id="rejection-reason-group" style="display: none;">
                        <label for="rejection-reason">Rejection Reason *</label>
                        <textarea id="rejection-reason" name="rejectionReason" rows="3" placeholder="Please provide reason for rejection..." required></textarea>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancel-action" class="btn btn-secondary">Cancel</button>
                        <button type="submit" id="confirm-action" class="btn btn-primary">Confirm</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Leave Details Modal -->
    <div id="leave-details-modal" class="modal">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h2>Leave Request Details</h2>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body" id="leave-details-content">
                <!-- Leave details will be loaded here -->
            </div>
        </div>
    </div>

    <script src="js/integration/api-client.js"></script>
    <script src="js/integration/utils.js"></script>
    <script src="js/leave-management.js"></script>
</body>
</html>